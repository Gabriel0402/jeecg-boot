{"remainingRequest":"/Users/chenyang/Documents/jeecg-boot/前端代码/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenyang/Documents/jeecg-boot/前端代码/src/views/dashboard/IndexDb.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenyang/Documents/jeecg-boot/前端代码/src/views/dashboard/IndexDb.vue","mtime":1596491763913},{"path":"/Users/chenyang/Documents/jeecg-boot/前端代码/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenyang/Documents/jeecg-boot/前端代码/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/chenyang/Documents/jeecg-boot/前端代码/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ChartCard from '@/components/ChartCard'\nimport ACol from \"ant-design-vue/es/grid/Col\"\nimport ATooltip from \"ant-design-vue/es/tooltip/Tooltip\"\nimport MiniArea from '@/components/chart/MiniArea'\nimport MiniBar from '@/components/chart/MiniBar'\nimport MiniProgress from '@/components/chart/MiniProgress'\nimport RankList from '@/components/chart/RankList'\nimport Bar from '@/components/chart/Bar'\nimport LineChartMultid from '@/components/chart/LineChartMultid'\nimport HeadInfo from '@/components/tools/HeadInfo.vue'\nimport { filterObj } from '@/utils/util'\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\"\nimport { getAction } from '@/api/manage'\n\nimport Trend from '@/components/Trend'\nimport { getLoginfo,getVisitInfo } from '@/api/api'\n\nconst rankList = []\nfor (let i = 0; i < 7; i++) {\n  rankList.push({\n    name: '白鹭岛 ' + (i+1) + ' 号店',\n    total: 1234.56 - i * 100\n  })\n}\nconst barData = []\nfor (let i = 0; i < 12; i += 1) {\n  barData.push({\n    x: `${i + 1}月`,\n    y: Math.floor(Math.random() * 1000) + 200\n  })\n}\nexport default {\n  name: \"IndexDb\",\n  components: {\n    ATooltip,\n    ACol,\n    ChartCard,\n    MiniArea,\n    MiniBar,\n    MiniProgress,\n    RankList,\n    Bar,\n    Trend,\n    LineChartMultid,\n    HeadInfo\n  },\n  data() {\n    return {\n      loading: true,\n      center: null,\n      rankList,\n      barData,\n      loginfo:{},\n      pipes:[],\n      senvalFields:['value'],\n      senval:[],\n      url: {\n        list: \"/pipeinfo/pipeInfo/list\",\n        slist:\"/senval/sensorValue/list\",\n      },\n      ipagination:{\n        current: 1,\n        pageSize: 10,\n        pageSizeOptions: ['10', '20', '30'],\n        showTotal: (total, range) => {\n          return range[0] + \"-\" + range[1] + \" 共\" + total + \"条\"\n        },\n        showQuickJumper: true,\n        showSizeChanger: true,\n        total: 0\n      },\n      columns: [\n        {\n          title: '#',\n          dataIndex: '',\n          key:'rowIndex',\n          width:60,\n          align:\"center\",\n          customRender:function (t,r,index) {\n            return parseInt(index)+1;\n          }\n        },\n        {\n          title:'管道设备ID',\n          align:\"center\",\n          dataIndex: 'pipeId'\n        },\n        {\n          title:'管道描述',\n          align:\"center\",\n          dataIndex: 'pipeDes'\n        },\n        {\n          title:'首纬度',\n          align:\"center\",\n          dataIndex: 'hlat'\n        },\n        {\n          title:'首经度',\n          align:\"center\",\n          dataIndex: 'hlong'\n        },\n        {\n          title:'尾纬度',\n          align:\"center\",\n          dataIndex: 'rlat'\n        },\n        {\n          title:'尾经度',\n          align:\"center\",\n          dataIndex: 'rlong'\n        },\n        {\n          title: '操作',\n          dataIndex: 'action',\n          align:\"center\",\n          scopedSlots: { customRender: 'action' },\n        }\n      ],\n      queryParam: {},\n      visitFields:['ip','visit'],\n      visitInfo:[],\n      indicator: <a-icon type=\"loading\" style=\"font-size: 24px\" spin />\n    }\n  },\n  computed: {\n    importExcelUrl: function(){\n      return `${window._CONFIG['domianURL']}/${this.url.importExcelUrl}`;\n    },\n  },\n  created() {\n    // setTimeout(() => {\n    //   this.loading = !this.loading\n    // }, 1000)\n    this.loadData();\n    getVisitInfo().then(res=>{\n        if(res.success){\n           this.visitInfo = res.result;\n           console.log(this.visitInfo);\n         }\n    })\n  },\n  methods: {\n    loadData () {\n      if(!this.url.list){\n        this.$message.error(\"请设置url.list属性!\")\n        return\n      }\n      var params = this.getQueryParams();\n      this.loading = true;\n      console.log(params);\n      getAction(this.url.list, '').then((res) => {\n        if (res.success) {\n          this.pipes = res.result.records;\n          console.log(this.pipes);\n          getAction(this.url.slist,'').then((res)=>{\n            if (res.success){\n              this.senval = res.result.records;\n              this.senval=this.senval.map((obj)=>{\n                obj['type']=obj['updateTime'];\n                delete obj['updateTime'];\n                return obj;\n              })\n              console.log(this.senval);\n            }\n          })\n          this.ipagination.total = res.result.total;\n        }\n        if(res.code===510){\n          this.$message.warning(res.message)\n        }\n        this.loading = false;\n      })\n    },\n    getQueryParams() {\n    //获取查询条件\n      let sqp = {}\n      if(this.superQueryParams){\n        sqp['superQueryParams']=encodeURI(this.superQueryParams)\n        sqp['superQueryMatchType'] = this.superQueryMatchType\n      }\n      var param = Object.assign(sqp, this.queryParam, this.isorter ,this.filters);\n      param.field = this.getQueryField();\n      param.pageNo = this.ipagination.current;\n      param.pageSize = this.ipagination.pageSize;\n      return filterObj(param);\n    },\n    getQueryField() {\n      //TODO 字段权限控制\n      var str = \"id,\";\n      this.columns.forEach(function (value) {\n        str += \",\" + value.dataIndex;\n      });\n      return str;\n    }\n  }\n}\n",null]}